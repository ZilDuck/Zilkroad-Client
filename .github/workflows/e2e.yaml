name: End-to-end tests
on: [push]
jobs:
  cypress-run:
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Install dependencies üì¶
        run: npm ci --legacy-peer-deps
      - name: Show Cypress information ‚ÑπÔ∏è
        run: npx cypress info
      - name: Verify Cypress can run üèÉ‚Äç‚ôÇÔ∏è
        run: npx cypress verify
      - name: Cypress run
        uses: cypress-io/github-action@v2
        with:
          build: npm run build
          start: npm start
          record: true
        env:
          # pass GitHub token to detect new build vs re-run build
          GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
          # overwrite commit message sent to Dashboard
          COMMIT_INFO_MESSAGE: ${{github.event.pull_request.title}}
          # re-enable PR comment bot
          COMMIT_INFO_SHA: ${{github.event.pull_request.head.sha}}

          CYPRESS_RECORD_KEY: ${{secrets.CYPRESS_RECORD_KEY}}
